(this.webpackJsonpcloud=this.webpackJsonpcloud||[]).push([[0],{102:function(e,t,n){},107:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},146:function(e,t,n){},158:function(e,t,n){},159:function(e,t,n){},204:function(e,t,n){},236:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n.n(r),s=n(58),i=n.n(s),o=(n(143),n(132)),l=n(22),j=(n(144),n(94)),u=n.n(j),b=n(125),d=n(20),h=(n(146),n(46)),O=(n(147),n(124),n(238),n(237),{apiKey:"AIzaSyDsEXIV0OTzWuRX4XBiVB4a-3w4bP_fnCs",authDomain:"chocolate-fiesta-cloud.firebaseapp.com",projectId:"chocolate-fiesta-cloud",storageBucket:"chocolate-fiesta-cloud.appspot.com",messagingSenderId:"419100703725",appId:"1:419100703725:web:42a642a456befea15045e4",measurementId:"G-FRZNRK641V"});h.a.initializeApp(O);var f=h.a.auth(),x=h.a.firestore(),p=h.a.storage(),m=(h.a.analytics(),n(6)),g=n(24),v=n.p+"static/media/logo.8bc7b652.png";function C(e){var t=e.setUser,n=Object(r.useState)(),c=Object(d.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(),l=Object(d.a)(o,2),j=l[0],h=l[1],O=Object(r.useState)(null),x=Object(d.a)(O,2),p=x[0],C=x[1],w=function(){var e=Object(b.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,f.signInWithEmailAndPassword(s,j).then((function(e){t(e)})).catch((function(e){C(e.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)("div",{className:"text-center login-wrapper",children:Object(a.jsxs)(m.a,{className:"form-signin",onSubmit:w,children:[Object(a.jsx)("img",{className:"mb-4",src:v,alt:"",width:"120"}),Object(a.jsx)("h1",{className:"h3 mb-3 font-weight-normal",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(a.jsxs)(m.a.Group,{controlId:"inputEmail",children:[Object(a.jsx)(m.a.Label,{className:"sr-only",children:"Email \u0430\u0434\u0440\u0435\u0441"}),Object(a.jsx)(m.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return i(e.target.value)}}),Object(a.jsx)(m.a.Text,{className:"text-danger",children:p})]}),Object(a.jsxs)(m.a.Group,{controlId:"inputPassword",children:[Object(a.jsx)(m.a.Label,{className:"sr-only",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(a.jsx)(m.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)}})]}),Object(a.jsx)(g.a,{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})})}var w=n(42),y=Object(r.createContext)();var S=n(75),N=n(19),L=n(14);function z(e){var t=e.updatePlot,n=e.setDrawSettings;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(m.a,{children:[Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0443\u0437\u043b\u0430\u043c\u0438, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"0.1",defaultValue:"2.0",onChange:function(e){return n({delta:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u042d\u043a\u0441\u0442\u0440\u0443\u0437\u0438\u044f, \u0435\u0434./\u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"0.01",defaultValue:"0.03",onChange:function(e){return n({e_per_mm:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"Z, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"0.01",defaultValue:"0.25",onChange:function(e){return n({z:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"Float"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"10",defaultValue:"2400",onChange:function(e){return n({f:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043f\u0435\u0447\u0430\u0442\u0438, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"120",onChange:function(e){return n({print_size_mm:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0441\u0442\u043e\u043b\u0430, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"200",onChange:function(e){return n({table_size_mm:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u041e\u0444\u0444\u0441\u0435\u0442 X, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"0",onChange:function(e){return n({offset_x:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u041e\u0444\u0444\u0441\u0435\u0442 Y, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"0",onChange:function(e){return n({offset_y:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u042d\u043a\u0441\u0442\u0440\u0443\u0434\u0435\u0440"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",min:"0",max:"1",defaultValue:"0",onChange:function(e){return n({tool:e.target.value})}})})]})]}),Object(a.jsx)(g.a,{onClick:function(){return t()},children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"})]})}var E="https://api.chocolatefiesta.ru",k=n(128),F=n.n(k),G=n(73),V=n(77);function D(e){return Object(r.useEffect)((function(){}),[e.plotData,e.fetchError]),e.fetchError?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(V.a,{variant:"danger",children:e.fetchError})}):e.plotData?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(F.a,{data:e.plotData.data,layout:{showlegend:!1,xaxis:{scaleanchor:"y",scaleratio:1},height:.6*window.innerHeight}})}):Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(G.a,{animation:"border",role:"status",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})})}var T=n(28);function P(e,t){return Object(w.a)(Object(w.a)({},e),t)}function _(e){return function(e){return p.ref("user").child(e).child("drawing.gcode")}(e).getDownloadURL().catch((function(e){console.log(e)}))}function R(){var e=Object(r.useContext)(y).user.user.uid,t=Object(r.useState)("#"),n=Object(d.a)(t,2),c=n[0],s=n[1],i=Object(r.useState)(null),o=Object(d.a)(i,2),l=o[0],j=o[1],u=Object(r.useState)(null),b=Object(d.a)(u,2),h=b[0],O=b[1],f=Object(r.useReducer)(P,{}),x=Object(d.a)(f,2),p=x[0],m=x[1];function v(e,t){return O(null),O(null),j(null),fetch(E+"/api/user/"+e+"/drawing/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(console.log(e),201===e.status|200===e.status)return e.json();throw 204===e.status?O('\u0420\u0438\u0441\u0443\u043d\u043e\u043a \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d. \u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 "\u0420\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435" \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u0440\u0438\u0441\u0443\u043d\u043e\u043a \u0432 \u043f\u0435\u0447\u0430\u0442\u044c'):O("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0440\u0438\u0441\u0443\u043d\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."),new Error(e)})).then((function(e){j(JSON.parse(e))})).catch((function(e){T.a(new Error(e))}))}return Object(r.useEffect)((function(){var t=!0;return _(e).then((function(e){t&&s(e)})),v(e,{}),function(){return t=!1}}),[e]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(S.a,{fluid:"xl",children:[Object(a.jsxs)(N.a,{children:[Object(a.jsx)(L.a,{sm:8,children:Object(a.jsx)(D,{fetchError:h,plotData:l})}),Object(a.jsx)(L.a,{sm:4,children:Object(a.jsx)(z,{updatePlot:function(){v(e,p),_(e).then((function(e){return s(e)}))},setDrawSettings:m})})]}),Object(a.jsx)(N.a,{children:Object(a.jsxs)(L.a,{children:[Object(a.jsx)(g.a,{as:"a",target:"_blank",href:c,className:"control-button",size:"lg",variant:"primary",download:!0,children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c GCODE"}),Object(a.jsx)(g.a,{as:"a",target:"_blank",href:"/draw",className:"control-button",size:"lg",variant:"secondary",children:"\u0420\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435"}),Object(a.jsx)(g.a,{disabled:!0,className:"control-button",variant:"secondary",size:"lg",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u0435\u0447\u0430\u0442\u044c"})]})})]})})}function U(){return Object(a.jsx)("h2",{children:"Library"})}var I=n(34),B=n(38),X=n(134),M=Object(X.a)({wrapper:{padding:[15]}});function J(){var e=M(),t=Object(r.useContext)(y),n=t.user,c=t.removeUser;return Object(a.jsx)("div",{className:e.wrapper,children:Object(a.jsxs)(B.a,{className:"justify-content-between",expand:"lg",children:[Object(a.jsx)(B.a.Brand,{href:"/",children:"Chocolate Fiesta Cloud \u03b2"}),Object(a.jsx)(B.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(a.jsxs)(B.a.Collapse,{id:"basic-navbar-nav",children:[Object(a.jsxs)(I.a,{className:"mr-auto",children:[Object(a.jsx)(I.a.Link,{href:"/draw-print",children:"\u041f\u0435\u0447\u0430\u0442\u044c \u0440\u0438\u0441\u0443\u043d\u043a\u0430"}),Object(a.jsx)(I.a.Link,{href:"/stl-generator",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 3D \u0442\u0435\u043a\u0441\u0442\u0430"})]}),Object(a.jsxs)(I.a,{className:"ml-auto",children:[Object(a.jsxs)(I.a.Link,{disabled:!0,children:["\u0412\u044b \u0432\u043e\u0448\u043b\u0438 \u043a\u0430\u043a ",n.user.email]}),Object(a.jsx)(I.a.Link,{onClick:c,children:"\u0412\u044b\u0439\u0442\u0438"})]})]})]})})}n(158);function Y(){return Object(a.jsx)("div",{className:"dash-wrapper",children:Object(a.jsx)("h2",{children:"\u041f\u0440\u0438\u0432\u0435\u0442, \u044d\u0442\u043e Chocolate Fiesta Cloud"})})}var W=n(59),A=c.a.createContext(),H=function(e){var t=e.children,n=Object(r.useState)(!1),c=Object(d.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(!1),l=Object(d.a)(o,2),j=l[0],u=l[1],b=Object(r.useRef)(null),h=Object(r.useRef)(null),O=Object(r.useState)([]),f=Object(d.a)(O,2),x=f[0],p=f[1],m=Object(r.useState)([]),g=Object(d.a)(m,2),v=g[0],C=g[1],w=Object(r.useState)([]),y=Object(d.a)(w,2),S=y[0],N=y[1],L=function(e){if(console.log(e.type),"mousemove"===e.type||"mousedown"===e.type)return{offsetX:e.offsetX,offsetY:e.offsetY};if("touchstart"===e.type||"touchmove"===e.type){var t=e.target.getBoundingClientRect();return{offsetX:e.touches[0].pageX-t.left,offsetY:e.touches[0].pageY-t.top}}};return Object(a.jsx)(A.Provider,{value:{canvasRef:b,contextRef:h,x:x,y:v,stops:S,isPrepared:s,prepareCanvas:function(){if(!s){var e=b.current,t=Math.min(window.innerWidth,window.innerHeight-128);e.width=2*t,e.height=2*t,e.style.width="".concat(t,"px"),e.style.height="".concat(t,"px");var n=e.getContext("2d");n.scale(2,2),n.lineCap="round",n.strokeStyle="brown",n.lineWidth=14,h.current=n,i(!0)}},startDrawing:function(e){var t=e.nativeEvent,n=L(t),a=n.offsetX,r=n.offsetY;h.current.beginPath(),h.current.moveTo(a,r),u(!0)},finishDrawing:function(){h.current.closePath(),u(!1),N([].concat(Object(W.a)(S),[x.length-1]))},clearCanvas:function(){var e=b.current,t=e.getContext("2d");t.fillStyle="white",t.fillRect(0,0,e.width,e.height),p([]),C([]),N([])},draw:function(e){var t=e.nativeEvent;if(j){var n=L(t),a=n.offsetX,r=n.offsetY;h.current.lineTo(a,r),h.current.stroke(),p([].concat(Object(W.a)(x),[a])),C([].concat(Object(W.a)(v),[r]))}}},children:t})},K=function(){return Object(r.useContext)(A)};n(159);function Z(){var e=K(),t=e.canvasRef,n=e.prepareCanvas,c=e.startDrawing,s=e.finishDrawing,i=e.draw;return Object(r.useEffect)(n,[n]),Object(a.jsx)("canvas",{onMouseDown:c,onMouseUp:s,onMouseMove:i,onTouchStart:c,onTouchEnd:s,onTouchMove:i,ref:t})}n(102);function q(){var e=Object(r.useContext)(y).user,t=K(),n=t.x,c=t.y,s=t.stops,i=Object(r.useState)(!1),o=Object(d.a)(i,2),l=o[0],j=o[1];function u(){return(t=e.user.uid,x.collection("user-drawing").doc(t)).set({x:n,y:c,stops:s});var t}function b(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),c=t[0],s=t[1];Object(r.useEffect)((function(){c&&u().then((function(){s(!1),j(!0)}))}),[c]);return Object(a.jsx)(g.a,{disabled:c||l||0===n.length,className:"control-button",size:"lg",variant:"success",onClick:c?null:function(){s(!0)},children:c?"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430...":l?"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u0435\u0447\u0430\u0442\u044c"})}return Object(r.useEffect)((function(){j(!1)}),[n]),Object(a.jsx)(b,{})}function Q(){var e=K(),t=e.x,n=e.clearCanvas;return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{className:"controls-wrapper",children:Object(a.jsx)(B.a,{fixed:"bottom",bg:"dark",className:"justify-content-center",children:Object(a.jsxs)(I.a,{children:[Object(a.jsx)(g.a,{onClick:n,disabled:0===t.length,className:"control-button",size:"lg",variant:"light",children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"}),Object(a.jsx)(q,{})]})})})})}var $=n(135);n(204);function ee(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{children:Object(a.jsxs)(B.a,{bg:"dark",variant:"dark",className:"justify-content-center",children:[Object(a.jsx)(B.a.Brand,{href:"/",children:"Chocolate Fiesta Draw"}),Object(a.jsx)(B.a.Collapse,{id:"basic-navbar-nav",children:Object(a.jsx)(I.a,{className:"ml-auto",children:Object(a.jsx)(I.a.Link,{href:"/draw-print",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043f\u0435\u0447\u0430\u0442\u0438"})})})]})})})}var te=function(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{className:"draw-app-wrapper",children:Object(a.jsx)($.a,Object(w.a)(Object(w.a)({},O),{},{firebase:h.a,children:Object(a.jsxs)(H,{children:[Object(a.jsx)(ee,{}),Object(a.jsx)(Z,{}),Object(a.jsx)(Q,{})]})}))})})};function ne(e){var t=e.updateSTL,n=e.setStlSettings;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(m.a,{children:[Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0422\u0435\u043a\u0441\u0442"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"text",defaultValue:"Chocolate Fiesta",onChange:function(e){return n({text:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0412\u044b\u0441\u043e\u0442\u0430 \u0438\u0437\u0434\u0435\u043b\u0438\u044f, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"5",onChange:function(e){return n({depth:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0438\u0437\u0434\u0435\u043b\u0438\u044f, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"100",onChange:function(e){return n({width:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0412\u044b\u0441\u043e\u0442\u0430 (z) \u043f\u043e\u0434\u043b\u043e\u0436\u043a\u0438, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"10",defaultValue:"2",onChange:function(e){return n({foundation_depth:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043f\u043e\u0434\u043b\u043e\u0436\u043a\u0438, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"0.1",defaultValue:"2",onChange:function(e){return n({foundation_offset:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0428\u0438\u0440\u0438\u043d\u0430 \u043f\u043e\u0434\u043b\u043e\u0436\u043a\u0438-\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0435\u043b\u044f \u0441\u043b\u043e\u0432, \u043c\u043c"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",step:"1",defaultValue:"7",onChange:function(e){return n({foundation_joiner_height:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u041c\u0435\u0436\u0431\u0443\u043a\u0432\u0435\u043d\u043d\u043e\u0435 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"number",defaultValue:"1.0",onChange:function(e){return n({text_spacing:e.target.value})}})})]}),Object(a.jsxs)(m.a.Group,{as:N.a,children:[Object(a.jsx)(m.a.Label,{column:!0,children:"\u0428\u0440\u0438\u0444\u0442"}),Object(a.jsx)(L.a,{children:Object(a.jsx)(m.a.Control,{size:"sm",type:"text",defaultValue:"Pacifico:style=Bold",onChange:function(e){return n({font:e.target.value})}})})]})]}),Object(a.jsx)(g.a,{onClick:function(){return t()},children:"\u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})}n(107);var ae=n(131);function re(e){return Object(r.useEffect)((function(){}),[e.stlUrl,e.fetchStlError]),e.fetchStlError?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(V.a,{variant:"danger",children:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430."})}):""===e.stlUrl?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(G.a,{animation:"border",role:"status",children:Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})})}):Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(ae.ModelViewer,{width:"100%",aspectgRatio:"100%",rotationSpeeds:[0,0,0],initControlPosition:[0,0,.4],backgroundColor:"#ffffff",url:e.stlUrl})})}function ce(e,t){return Object(w.a)(Object(w.a)({},e),t)}function se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return fetch(e,t).then((function(a){if(a.ok)return a.json();if(n>0)return se(e,t,n-1);throw new Error(a)})).catch((function(a){if(n>0)return se(e,t,n-1);throw new Error(a)}))}function ie(){var e=Object(r.useContext)(y).user.user.uid,t=Object(r.useState)(""),n=Object(d.a)(t,2),c=n[0],s=n[1],i=Object(r.useReducer)(ce,{}),o=Object(d.a)(i,2),l=o[0],j=o[1],u=Object(r.useState)(!1),b=Object(d.a)(u,2),h=b[0],O=b[1];function f(e,t){return se(E+"/api/stl-generator/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch((function(e){O(!0),T.a(new Error(e))})).then((function(e){return e}))}return Object(r.useEffect)((function(){var e=!0;return f(0,{}).then((function(t){e&&null!=t&&s(t.url)})),function(){return e=!1}}),[e]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(S.a,{fluid:"xl",className:"stl-generator-wrapper",children:[Object(a.jsxs)(N.a,{children:[Object(a.jsx)(L.a,{sm:7,children:Object(a.jsx)(re,{fetchStlError:h,stlUrl:c})}),Object(a.jsx)(L.a,{sm:5,children:Object(a.jsx)(ne,{updateSTL:function(){s(""),f(0,l).then((function(e){e&&(O(!1),s(e.url))}))},setStlSettings:j})})]}),Object(a.jsx)(N.a,{children:Object(a.jsxs)(L.a,{children:[Object(a.jsx)(g.a,{as:"a",target:"_blank",href:c,className:"control-button",size:"lg",variant:"primary",download:!0,children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c STL"}),Object(a.jsx)(g.a,{disabled:!0,className:"control-button",size:"lg",variant:"primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u0435\u0447\u0430\u0442\u044c"})]})})]})})}var oe=function(){var e=function(){var e=Object(r.useState)(function(){var e=localStorage.getItem("user");return e?JSON.parse(e):null}()),t=Object(d.a)(e,2),n=t[0],a=t[1],c=function(e){localStorage.setItem("user",JSON.stringify(e)),a(e)};return{setUser:c,user:n,removeUser:function(){c(null)}}}(),t=e.user,n=e.setUser,c=e.removeUser;return t?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(y.Provider,{value:{user:t,setUser:n,removeUser:c},children:Object(a.jsx)(o.a,{children:Object(a.jsxs)(l.c,{children:[Object(a.jsx)(l.a,{exact:!0,path:"/draw",children:Object(a.jsx)(te,{})}),Object(a.jsxs)(l.a,{path:"/",children:[Object(a.jsx)(J,{}),Object(a.jsx)(l.a,{exact:!0,path:"/",children:Object(a.jsx)(R,{})}),Object(a.jsx)(l.a,{path:"/draw-print",children:Object(a.jsx)(R,{})}),Object(a.jsx)(l.a,{path:"/library",children:Object(a.jsx)(U,{})}),Object(a.jsx)(l.a,{path:"/slicer",children:Object(a.jsx)(Y,{})}),Object(a.jsx)(l.a,{path:"/stl-generator",children:Object(a.jsx)(ie,{})})]})]})})})}):Object(a.jsx)(C,{setUser:n})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,247)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},je=(n(235),n(245)),ue=n(133);je.a({dsn:"https://671da45dc307486090d441b0ff074028@o528559.ingest.sentry.io/5646853",integrations:[new ue.a.BrowserTracing],tracesSampleRate:1}),i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(oe,{})}),document.getElementById("root")),le()}},[[236,1,2]]]);
//# sourceMappingURL=main.ccfad70d.chunk.js.map